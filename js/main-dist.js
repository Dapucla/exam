$(document).ready((function(){$(".header__switcher_circle").on("click",(function(){$("body").hasClass("dark-theme")?$(".dark-mode").text("Dark mode"):$(".dark-mode").text("Light mode"),$("body").toggleClass("dark-theme")}))}));var delay_popup=1e3;setTimeout("document.getElementById('overlay').style.display='block'",delay_popup);var addPl=new Vue({el:".all",data:{taskIsAdded:!1,isPageLoaded:!0,status:"",user:"",date:"",desci:"",dateHours:"",dateMinutes:"",targ:"",dateSeconds:"",finalDate:"",finalDateHours:"",finalDateMinutes:"",finalDateSeconds:"",dateDiff:"",new_task:[{id:"",desc:"",status:""}],process:[{id:"",desc:"",status:"",date:""}],done:[{id:"",desc:"",status:"",date:"",finalDate:""}],count:1},methods:{set_user(){$(event.target).closest(".popup").find(":input").val();""==$("#userid").val()?alert("Введите имя ответственного!"):(this.new_task.user,this.isPageLoaded=!1)},add_task(){""==this.desci?alert("Заполните поле!"):this.new_task.push({id:this.count++,desc:this.desci,status:"Plan"}),this.new_task.desc="",console.log(this.count)},close_task(){$(".popup-close").click((function(){return $(this).parents(".popup-fade").fadeOut(),!1}))},edit_desc:function(e){targ=$(e.target),$(".popup-fade").fadeIn();var t=$(e.target).closest(".columns").find("proverka").attr("class"),a=$(e.target).closest("li").find("p"),s=$(e.target).closest("li"),n=$("#cng-desc").val();new Date;"columns__plan proverka"==$(e.target).closest(".proverka").attr("class")?($(".popup__start-date").addClass("hide"),$(".popup__final-date").addClass("hide")):"columns__process proverka"==$(e.target).closest(".proverka").attr("class")?$(".popup__start-date").removeClass("hide"):"columns__done proverka"==$(e.target).closest(".proverka").attr("class")&&($(".popup__start-date").removeClass("hide"),$(".popup__final-date").removeClass("hide")),console.log(t),"columns__plan proverka"==$(e.target).closest(".proverka").attr("class")&&(""==n?alert("Заполните поле!"):$(".submit_btn").click((function(t){var n=$("#cng-desc").val(),d=$("#status").val();if($(a).text(n),"plan"==d)$(s).appendTo(".columns__plan"),$(".new-date-par").addClass("hide"),$(".date-par").addClass("hide"),$(".new-date-par").remove(),$("new-date-par").detach(":empty"),$(".date-par").remove(),$(".date-par").detach(":empty");else if("process"==d){var i=new Date;this.date=i;var o=$("#cng-start-time");$(o).val(this.date),$(".date-par").removeClass("hide");var l=$(".date-par");$(l).addClass(" check-done");var c=$(e.target).closest(".columns__plan_icons").find(".fa-times-circle");$(s).appendTo(".columns__process"),$(".new-date-par").addClass("hide"),$(".new-date-span").addClass("hide"),"date-par check-done"!=$(l).attr("class")&&$(a).after('<span class="date-par">Дата и время начала: <span class="date-span">'+this.date+"</span></span>"),$(c).removeClass("fas fa-times-circle").addClass("far fa-check-circle");var r=new Date;this.date=r,this.dateHours=r.getHours(),this.dateMinutes=r.getMinutes(),this.dateSeconds=r.getSeconds(),$(s).appendTo(".columns__process")}else if("done"==d){statusFinalDate=new Date,this.finalDate=statusFinalDate;var p=$("#cng-final-time");$(p).val(this.finalDate);var u=$(e.target).closest(".columns__plan_desc").find("span");$(s).appendTo(".columns__done");c=$(e.target).closest(".columns__plan_icons").find(".fa-check-circle"),$(e.target).closest("li").find(".date-par");var f=new Date;$(".new-date-par").text(""),this.finalDateHours=f.getHours(),this.finalDateMinutes=f.getMinutes(),this.finalDateSeconds=f.getSeconds(),$(s).appendTo(".columns__done"),"new-date-par new-check-done"!=$(u).attr("class")&&($(e.target).closest(".columns__plan_block").find(".columns__plan_desc").after('<span class="new-date-par"> Дата и время окончания: <span class="new-date-span">'+this.finalDate+"</span></span>"),$(e.target).closest(".columns__plan_block").find(".columns__plan_desc").after('<span class="new-date-par"> Затрачено времени: <span class="new-date-span">'+(this.finalDateHours-this.dateHours)+":"+(this.finalDateMinutes-this.dateMinutes)+":"+(this.finalDateSeconds-this.dateSeconds)+"</span></span>"),$(c).removeClass("far fa-check-circle").addClass("fas fa-times-circle")),$(u).addClass(" new-check-done")}$(this).parents(".popup-fade").fadeOut(),console.log(d)})))},edit_task:function(e){},next_plan:function(e){var t=$(e.target).closest("li").find(".columns__plan_desc").text(),a=$(e.target).closest("li").find(".indef").text();this.new_task.pop({id:a});var s=new Date;this.date=s,this.dateHours=s.getHours(),this.dateMinutes=s.getMinutes(),this.dateSeconds=s.getSeconds(),this.process.push({id:a,desc:t,status:"Process",date:new Date})},next_process:function(e){var t=$(e.target).closest("li").find(".indef").text(),a=$(e.target).closest("li").find(".columns__plan_desc").text(),s=$(e.target).closest(".columns__plan_icons").find(".fa-times-circle"),n=new Date;this.finalDate=n,this.finalDateHours=n.getHours(),this.finalDateMinutes=n.getMinutes(),this.finalDateSeconds=n.getSeconds(),console.log(t),this.process.pop({id:t}),this.done.push({id:t,desc:a,status:"Process",date:new Date,finalDate:new Date,dateDiff:this.finalDateHours-this.dateHours+":"+(this.finalDateMinutes-this.dateMinutes)+":"+(this.finalDateSeconds-this.dateSeconds)}),$(s).removeClass("far fa-check-circle").addClass("fas fa-times-circle")},next_done:function(e){var t=$(e.target).closest("li").find(".indef").text();this.done.pop({id:t})},drop:function(e,t){$(e.target).closest(".proverka").attr("class"),$(e.target).closest("li");const a=e.dataTransfer.getData("itemID"),s=this.new_task.find(e=>e.title==a);s.tag=t,"columns__process"==s.tag&&(this.date=(new Date).toLocaleString())},drag:function(t,a){e.target;t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("itemID",a.title)}}});